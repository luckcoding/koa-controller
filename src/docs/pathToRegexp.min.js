var DEFAULT_DELIMITER="/";var PATH_REGEXP=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function parse(q,d){var l=[];var z=0;var g=0;var n="";var p=(d&&d.delimiter)||DEFAULT_DELIMITER;var f=(d&&d.whitelist)||undefined;var u=false;var A;while((A=PATH_REGEXP.exec(q))!==null){var r=A[0];var h=A[1];var e=A.index;n+=q.slice(g,e);g=e+r.length;if(h){n+=h[1];u=true;continue}var o="";var B=A[2];var s=A[3];var i=A[4];var a=A[5];if(!u&&n.length){var t=n.length-1;var x=n[t];var b=f?f.indexOf(x)>-1:true;if(b){o=x;n=n.slice(0,t)}}if(n){l.push(n);n="";u=false}var j=a==="+"||a==="*";var w=a==="?"||a==="*";var v=s||i;var y=o||p;l.push({name:B||z++,prefix:o,delimiter:y,optional:w,repeat:j,pattern:v?escapeGroup(v):"[^"+escapeString(y===p?y:(y+p))+"]+?"})}if(n||g<q.length){l.push(n+q.substr(g))}return l}function compile(b,a){return tokensToFunction(parse(b,a),a)}function match(d,a){var c=[];var b=pathToRegexp(d,c,a);return regexpToFunction(b,c)}function regexpToFunction(a,b){return function(d,l){var e=a.exec(d);if(!e){return false}var k=e[0];var h=e.index;var f={};var c=(l&&l.decode)||decodeURIComponent;for(var g=1;g<e.length;g++){if(e[g]===undefined){continue}var j=b[g-1];if(j.repeat){f[j.name]=e[g].split(j.delimiter).map(function(i){return c(i,j)})}else{f[j.name]=c(e[g],j)}}return{path:k,index:h,params:f}}}function tokensToFunction(d,a){var c=new Array(d.length);for(var b=0;b<d.length;b++){if(typeof d[b]==="object"){c[b]=new RegExp("^(?:"+d[b].pattern+")$",flags(a))}}return function(g,p){var o="";var l=(p&&p.encode)||encodeURIComponent;var m=p?p.validate!==false:true;for(var h=0;h<d.length;h++){var e=d[h];if(typeof e==="string"){o+=e;continue}var n=g?g[e.name]:undefined;var k;if(Array.isArray(n)){if(!e.repeat){throw new TypeError('Expected "'+e.name+'" to not repeat, but got array')}if(n.length===0){if(e.optional){continue}throw new TypeError('Expected "'+e.name+'" to not be empty')}for(var f=0;f<n.length;f++){k=l(n[f],e);if(m&&!c[h].test(k)){throw new TypeError('Expected all "'+e.name+'" to match "'+e.pattern+'"')}o+=(f===0?e.prefix:e.delimiter)+k}continue}if(typeof n==="string"||typeof n==="number"||typeof n==="boolean"){k=l(String(n),e);if(m&&!c[h].test(k)){throw new TypeError('Expected "'+e.name+'" to match "'+e.pattern+'", but got "'+k+'"')}o+=e.prefix+k;continue}if(e.optional){continue}throw new TypeError('Expected "'+e.name+'" to be '+(e.repeat?"an array":"a string"))}return o}}function escapeString(a){return a.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function escapeGroup(a){return a.replace(/([=!:$/()])/g,"\\$1")}function flags(a){return a&&a.sensitive?"":"i"}function regexpToRegexp(d,c){if(!c){return d}var a=d.source.match(/\((?!\?)/g);if(a){for(var b=0;b<a.length;b++){c.push({name:b,prefix:null,delimiter:null,optional:false,repeat:false,pattern:null})}}return d}function arrayToRegexp(e,c,a){var d=[];for(var b=0;b<e.length;b++){d.push(pathToRegexp(e[b],c,a).source)}return new RegExp("(?:"+d.join("|")+")",flags(a))}function stringToRegexp(c,b,a){return tokensToRegExp(parse(c,a),b,a)}function tokensToRegExp(h,m,o){o=o||{};var j=o.strict;var b=o.start!==false;var e=o.end!==false;var a=o.delimiter||DEFAULT_DELIMITER;var f=[].concat(o.endsWith||[]).map(escapeString).concat("$").join("|");var k=b?"^":"";for(var g=0;g<h.length;g++){var d=h[g];if(typeof d==="string"){k+=escapeString(d)}else{var l=d.repeat?"(?:"+d.pattern+")(?:"+escapeString(d.delimiter)+"(?:"+d.pattern+"))*":d.pattern;if(m){m.push(d)}if(d.optional){if(!d.prefix){k+="("+l+")?"}else{k+="(?:"+escapeString(d.prefix)+"("+l+"))?"}}else{k+=escapeString(d.prefix)+"("+l+")"}}}if(e){if(!j){k+="(?:"+escapeString(a)+")?"}k+=f==="$"?"$":"(?="+f+")"}else{var c=h[h.length-1];var n=typeof c==="string"?c[c.length-1]===a:c===undefined;if(!j){k+="(?:"+escapeString(a)+"(?="+f+"))?"}if(!n){k+="(?="+escapeString(a)+"|"+f+")"}}return new RegExp(k,flags(o))}function pathToRegexp(c,b,a){if(c instanceof RegExp){return regexpToRegexp(c,b)}if(Array.isArray(c)){return arrayToRegexp((c),b,a)}return stringToRegexp((c),b,a)};